/*
 * File: app/view/ProjectViewController.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Code.view.ProjectViewController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.project',

    onButtonClick: function(button, e, eOpts) {
        var grid = button.up("grid");
        var selection = grid.getSelection();
        if(selection.length>0){
            var model = selection[0];
            var layout = Ext.getCmp("codeviewport").getLayout();
            var code = layout.getNext();
            code.getViewModel().set("project",model.getData());
            layout.next();
        }else{
            Ext.Msg.alert("提示","先选择，在进行项目管理");
        }

    },

    onButtonClick1: function(button, e, eOpts) {
        var form = Ext.getCmp("projectform");
        var viewmodel = form.getViewModel();
        viewmodel.set("model",{});
    },

    deleteProject: function(button, e, eOpts) {
        var grid = button.up("grid");
        var selection = grid.getSelection();
        if(selection.length>0){
            Ext.Msg.confirm("警告","谨慎删除警告",function(btn){
                if(btn=='yes'||btn=='ok'){
                    var model = selection[0];
                    var id = model.get("id");
                    Ext.Ajax.request({
                        url:SERVER+'/project/delete',
                        params:{id:id},
                        success:function(){
                            Ext.getStore("ProjectStore").reload();
                        }
                    });
                }
            });
        }else{
            Ext.Msg.alert("提示","先选择，后删除");
        }

    },

    onGridpanelSelect: function(rowmodel, record, index, eOpts) {
        var form = Ext.getCmp("projectform");
        var viewmodel = form.getViewModel();
        viewmodel.set("model",record.getData());
    }

});
